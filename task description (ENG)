The Head of the Customer Support Department wants to obtain information on how well his employees (account managers) are handling one of their key responsibilities – contract prolongation with clients. From the analyst, he expects to receive a report on employee prolongations for 2023.
The company uses two prolongation coefficients:

For projects prolonged in the first month – the ratio of the shipment amount of projects prolonged in the first month after completion to the shipment amount of the last month of realization of all projects completed in the previous month.

For projects prolonged in the second month – the ratio of the shipment amount of projects prolonged in the second month to the shipment amount of the last month of projects not prolonged in the first month.

In other words, if we need to understand how well a manager prolonged in May, we need to calculate:
The shipment amount of projects completed in April (for April) and the shipment amount of those projects completed in April that also had shipments in May (for May). The coefficient is the ratio of the second amount to the first.
The shipment amount of projects completed in March that had no shipments in April (for March) and the shipment amount of those projects completed in March that had no shipments in April but had in May (for May). The coefficient is the ratio of the second amount to the first.

Two datasets are available:

prolongations.csv
id – project id
month – last month of project realization
AM – full name of the responsible account manager (these data are primary in relation to financial_data)

financial_data.csv
id – project id
Причина дубля – reason why rows with the same id appear multiple times
Columns with month names – shipment amount of the project in that month
Account – full name of the responsible account manager

Required:
Calculate prolongation coefficients for each manager and for the entire department:
by each month

by year
